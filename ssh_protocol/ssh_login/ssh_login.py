import pexpect

# List of possible command prompts
COMMAND_PROMPTS = ["#", ">>>", ">", "\\$"]

def send_command(command_prompt, command):
    command_prompt.sendline(command)
    command_prompt.expect(COMMAND_PROMPTS)
    print(command_prompt.before.decode())

def connect(user, host, password):
    ssh_new_key_prompt = "Are you sure you want to continue connecting"
    ssh_command = f"ssh -oHostKeyAlgorithms=+ssh-rsa {user}@{host}"
    try:
        command_prompt = pexpect.spawn(ssh_command)
        return_code = command_prompt.expect([pexpect.TIMEOUT, ssh_new_key_prompt, "[P|p]assword: "])

        if return_code == 0:
            print("[-] Error connecting: Timeout")
            return None
        elif return_code == 1:
            command_prompt.sendline("yes")
            command_prompt.expect("[P|p]assword: ")

        command_prompt.sendline(password)
        command_prompt.expect(COMMAND_PROMPTS)
        return command_prompt
    except pexpect.ExceptionPexpect as e:
        print("[-] Error connecting:", str(e))
        return None

def main():
    host = input("Enter the SSH host to connect: ")
    username = input("Enter the SSH username: ")
    password = input("Enter the SSH password: ")

    command_prompt = connect(username, host, password)
    if command_prompt:
        send_command(command_prompt, "ls")
        send_command(command_prompt, "pwd")
        send_command(command_prompt, "whoami")

# Call the main function to start the script
main()
