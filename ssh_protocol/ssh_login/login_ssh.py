import pexpect

# List of possible command prompts
COMMAND_PROMPTS = ["#", ">>>", ">", "\\$"]

def send_command(command_prompt, command):
    command_prompt.sendline(command)
    command_prompt.expect(COMMAND_PROMPTS)
    print(command_prompt.before.decode())

def connect(user, host, password):
    ssh_new_key_prompt = "Are you sure you want to continue connecting"
    ssh_command = f"ssh -oHostKeyAlgorithms=+ssh-rsa {user}@{host}"
    try:
        command_prompt = pexpect.spawn(ssh_command)
        return_code = command_prompt.expect([pexpect.TIMEOUT, ssh_new_key_prompt, "[P|p]assword: "])

        if return_code == 0:
            print("[-] Error connecting: Timeout")
            return None
        elif return_code == 1:
            command_prompt.sendline("yes")
            command_prompt.expect("[P|p]assword: ")

        command_prompt.sendline(password)
        command_prompt.expect(COMMAND_PROMPTS)
        return command_prompt
    except pexpect.ExceptionPexpect as e:
        print("[-] Error connecting:", str(e))
        return None

def main():
    ip_range = "192.168.30."
    for i in range(1, 255):
        ip_address = ip_range + str(i)
        # print(f"{i}. {ip_address}")
    
    ip_index = int(input("Enter the Host IP address to connect: "))
    host = ip_range + str(ip_index)
    
    print("Username Options:")
    print("1. root")
    print("2. msfadmin")
    print("3. admin")
    print("4. Custom")
    username_index = int(input("Enter the index of the username: "))

    if username_index == 1:
        username = "root"
    elif username_index == 2:
        username = "msfadmin"
    elif username_index == 3:
        username = "admin"
    elif username_index == 4:
        username = input("Enter the custom username: ")
    else:
        print("Invalid username index. Using default username 'root'.")
        username = "root"

    print("Password Options:")
    print("1. root")
    print("2. msfadmin")
    print("3. password")
    print("4. Custom")
    password_index = input("Enter the index of the password: ")

    if password_index == "1":
        password = "root"
    elif password_index == "2":
        password = "msfadmin"
    elif password_index == "3":
        password = "password"
    elif password_index == "4":
        password = input("Enter the custom password: ")
    else:
        print("Invalid password index. Using default password 'root'.")
        password = "root"

    command_prompt = connect(username, host, password)  # Connect to the remote host

    if command_prompt:
        send_command(command_prompt, "ifconfig")
        send_command(command_prompt, "whoami")
         # Send a command to the remote host

# Call the main function to start the script
main()
