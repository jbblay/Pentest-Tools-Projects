#!/usr/bin/python3

import requests
import sys
from concurrent.futures import ThreadPoolExecutor

# ANSI color codes for red text
RED = "\033[91m"
RESET = "\033[0m"

def check_directory(url):
    try:
        response = requests.get(url)
        if response.status_code == 200:
            return True
        else:
            return False
    except requests.exceptions.RequestException:
        return False

target_url = input("[+] Enter Target URL: ")

# Add "http://" prefix if not already present
if not target_url.startswith("http://") and not target_url.startswith("https://"):
    target_url = "http://" + target_url

with open("common.txt", "r") as file:
    directory_names = [line.strip() for line in file]

    with ThreadPoolExecutor() as executor:
        results = []
        for directory_name in directory_names:
            full_url = target_url + "/" + directory_name
            results.append(executor.submit(check_directory, full_url))

        for i, result in enumerate(results):
            directory_name = directory_names[i]
            full_url = target_url + "/" + directory_name
            if result.result():
                print("[+] Discovered Directory: " + RED + directory_name + RESET)
